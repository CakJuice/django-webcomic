{% extends 'layouts/main_layout.html' %}

{% block meta_description %}Create your new comic{% endblock %}
{% block meta_keywords %}Comic, Create{% endblock %}
{% block title %}Create New Comic{% endblock %}

{% block content %}
  <div class="container my-3" id="main-content">
    <div class="row justify-content-center">
      <div class="col col-lg-6 col-md-8 col-12">
        <h3>Create New Comic</h3>
<!--        <form method="POST" enctype="multipart/form-data" onsubmit="submitFormAjax(this); return false;" novalidate>-->
        <form method="POST" enctype="multipart/form-data" @submit.prevent="submitForm" novalidate>
          {% csrf_token %}
          {% include 'includes/form.html' %}
          <button type="submit" class="btn btn-success">Submit</button>
          <a role="button" class="btn btn-secondary" href="{% url 'homepage' %}">Cancel</a>
        </form>
      </div>
    </div>
  </div>
{% endblock %}

{% block extra_script %}
<script>
  var urlPost = "{% url 'comic_create' %}";
  var comicForm = new Vue({
    el: '#main-content',
    data: {
      csrfmiddlewaretoken: '{{ csrf_token }}',
      title: '',
      description: '',
      genre: '',
      errors: [
        title: '',
        description: '',
        genre: '',
      ]
    },
    methods: {
      submitForm: function() {
        console.log(this);
        var self = this;
        this.$http.post(urlPost, {
          csrfmiddlewaretoken: this.csrfmiddlewaretoken,
          title: this.title,
          description: this.description,
          genre: this.genre,
        }, {
          headers: {
            'X-CSRFToken': this.csrfmiddlewaretoken,
            'X-Requested-With': 'XMLHttpRequest',
          },
        }).then(function(response) {
          console.log(response);
        });
      },
    },
  });
</script>
{% endblock %}